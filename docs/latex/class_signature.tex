\hypertarget{class_signature}{}\doxysection{Signature Class Reference}
\label{class_signature}\index{Signature@{Signature}}


A class for reading the headers of a Windows executable and calculating its SHA256 hash value.  




{\ttfamily \#include $<$signature.\+h$>$}

\doxysubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{class_signature_a076653a1d82cf7a436c20d966247fc3e}{Signature}} (std\+::string filename)
\begin{DoxyCompactList}\small\item\em Constructor which takes a file name as an argument and opens the file in binary mode. The constructor reads the MS-\/\+DOS header and PE header of the file. \end{DoxyCompactList}\item 
\mbox{\hyperlink{class_signature_ad0bb12039b385e4600dddc7d703f52fb}{$\sim$\+Signature}} ()
\begin{DoxyCompactList}\small\item\em Destroys the \mbox{\hyperlink{class_signature}{Signature}} object and closes the file. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{class_signature_a114a817dedf1412b461d9fe4ec9752e0}{get\+\_\+\+PE\+\_\+offset}} ()
\begin{DoxyCompactList}\small\item\em Returns the offset of the PE header in the file. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{class_signature_a832f49deb8bb78a2503cec99df5a0f3b}{get\+\_\+\+Sections\+\_\+offset}} ()
\begin{DoxyCompactList}\small\item\em Returns the offset of the section headers in the file. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{class_signature_af9c9d17beeaa1305e666b469b193248f}{get\+\_\+number\+\_\+of\+\_\+sections}} ()
\begin{DoxyCompactList}\small\item\em Returns the number of sections in the headers of the file. \end{DoxyCompactList}\item 
long int \mbox{\hyperlink{class_signature_a8881448fcd549267f338a61957196dde}{sum\+\_\+up\+\_\+bytes}} (unsigned short size, int pos=-\/1)
\begin{DoxyCompactList}\small\item\em Reads the specified number of bytes from the file at the given position, and returns the sum of the bytes computed as an integer. \end{DoxyCompactList}\item 
std\+::string \mbox{\hyperlink{class_signature_afae6fd692e7618d91b75973d947f5193}{get\+\_\+hash}} ()
\begin{DoxyCompactList}\small\item\em Returns the SHA256 hash of the {\ttfamily .text} section of the file. \end{DoxyCompactList}\item 
std\+::vector$<$ unsigned char $>$ \mbox{\hyperlink{class_signature_a269fe4069b8a97612228b07baa17d3f0}{get\+\_\+\+MS\+\_\+\+DOS\+\_\+\+HEADER\+\_\+\+BUFFER}} () const
\begin{DoxyCompactList}\small\item\em Returns the MS-\/\+DOS header buffer. \end{DoxyCompactList}\item 
std\+::vector$<$ unsigned char $>$ \mbox{\hyperlink{class_signature_a97711184a9117cdb06644b347a8ac75e}{get\+\_\+\+PE\+\_\+\+HEADER\+\_\+\+BUFFER}} () const
\begin{DoxyCompactList}\small\item\em Returns the PE header buffer. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
A class for reading the headers of a Windows executable and calculating its SHA256 hash value. 

\doxysubsection{Constructor \& Destructor Documentation}
\mbox{\Hypertarget{class_signature_a076653a1d82cf7a436c20d966247fc3e}\label{class_signature_a076653a1d82cf7a436c20d966247fc3e}} 
\index{Signature@{Signature}!Signature@{Signature}}
\index{Signature@{Signature}!Signature@{Signature}}
\doxysubsubsection{\texorpdfstring{Signature()}{Signature()}}
{\footnotesize\ttfamily Signature\+::\+Signature (\begin{DoxyParamCaption}\item[{std\+::string}]{filename }\end{DoxyParamCaption})}



Constructor which takes a file name as an argument and opens the file in binary mode. The constructor reads the MS-\/\+DOS header and PE header of the file. 


\begin{DoxyParams}{Parameters}
{\em filename} & The name of the file to open.\\
\hline
\end{DoxyParams}

\begin{DoxyExceptions}{Exceptions}
{\em std\+::ifstream\+::failure} & If the file cannot be opened. \\
\hline
\end{DoxyExceptions}
\mbox{\Hypertarget{class_signature_ad0bb12039b385e4600dddc7d703f52fb}\label{class_signature_ad0bb12039b385e4600dddc7d703f52fb}} 
\index{Signature@{Signature}!````~Signature@{$\sim$Signature}}
\index{````~Signature@{$\sim$Signature}!Signature@{Signature}}
\doxysubsubsection{\texorpdfstring{$\sim$Signature()}{~Signature()}}
{\footnotesize\ttfamily Signature\+::$\sim$\+Signature (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Destroys the \mbox{\hyperlink{class_signature}{Signature}} object and closes the file. 

This destructor destroys the \mbox{\hyperlink{class_signature}{Signature}} object and closes the file associated with it. 

\doxysubsection{Member Function Documentation}
\mbox{\Hypertarget{class_signature_afae6fd692e7618d91b75973d947f5193}\label{class_signature_afae6fd692e7618d91b75973d947f5193}} 
\index{Signature@{Signature}!get\_hash@{get\_hash}}
\index{get\_hash@{get\_hash}!Signature@{Signature}}
\doxysubsubsection{\texorpdfstring{get\_hash()}{get\_hash()}}
{\footnotesize\ttfamily std\+::string Signature\+::get\+\_\+hash (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Returns the SHA256 hash of the {\ttfamily .text} section of the file. 

The method uses the \mbox{\hyperlink{class_signature_a8881448fcd549267f338a61957196dde}{sum\+\_\+up\+\_\+bytes()}} function to compute the size and offset of the raw data of the {\ttfamily .text} section, and then reads the raw data and computes its hash using the sha256() function.


\begin{DoxyExceptions}{Exceptions}
{\em std\+::ifstream\+::failure} & If the file cannot be read.\\
\hline
\end{DoxyExceptions}
\begin{DoxyReturn}{Returns}
The SHA256 hash of the {\ttfamily .text} section of the file. 
\end{DoxyReturn}
\mbox{\Hypertarget{class_signature_a269fe4069b8a97612228b07baa17d3f0}\label{class_signature_a269fe4069b8a97612228b07baa17d3f0}} 
\index{Signature@{Signature}!get\_MS\_DOS\_HEADER\_BUFFER@{get\_MS\_DOS\_HEADER\_BUFFER}}
\index{get\_MS\_DOS\_HEADER\_BUFFER@{get\_MS\_DOS\_HEADER\_BUFFER}!Signature@{Signature}}
\doxysubsubsection{\texorpdfstring{get\_MS\_DOS\_HEADER\_BUFFER()}{get\_MS\_DOS\_HEADER\_BUFFER()}}
{\footnotesize\ttfamily std\+::vector$<$ unsigned char $>$ Signature\+::get\+\_\+\+MS\+\_\+\+DOS\+\_\+\+HEADER\+\_\+\+BUFFER (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const}



Returns the MS-\/\+DOS header buffer. 

\begin{DoxyReturn}{Returns}
The MS-\/\+DOS header buffer. 
\end{DoxyReturn}
\mbox{\Hypertarget{class_signature_af9c9d17beeaa1305e666b469b193248f}\label{class_signature_af9c9d17beeaa1305e666b469b193248f}} 
\index{Signature@{Signature}!get\_number\_of\_sections@{get\_number\_of\_sections}}
\index{get\_number\_of\_sections@{get\_number\_of\_sections}!Signature@{Signature}}
\doxysubsubsection{\texorpdfstring{get\_number\_of\_sections()}{get\_number\_of\_sections()}}
{\footnotesize\ttfamily int Signature\+::get\+\_\+number\+\_\+of\+\_\+sections (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Returns the number of sections in the headers of the file. 

\begin{DoxyReturn}{Returns}
The number of sections in the headers of the file. 
\end{DoxyReturn}
\mbox{\Hypertarget{class_signature_a97711184a9117cdb06644b347a8ac75e}\label{class_signature_a97711184a9117cdb06644b347a8ac75e}} 
\index{Signature@{Signature}!get\_PE\_HEADER\_BUFFER@{get\_PE\_HEADER\_BUFFER}}
\index{get\_PE\_HEADER\_BUFFER@{get\_PE\_HEADER\_BUFFER}!Signature@{Signature}}
\doxysubsubsection{\texorpdfstring{get\_PE\_HEADER\_BUFFER()}{get\_PE\_HEADER\_BUFFER()}}
{\footnotesize\ttfamily std\+::vector$<$ unsigned char $>$ Signature\+::get\+\_\+\+PE\+\_\+\+HEADER\+\_\+\+BUFFER (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const}



Returns the PE header buffer. 

\begin{DoxyReturn}{Returns}
The PE header buffer. 
\end{DoxyReturn}
\mbox{\Hypertarget{class_signature_a114a817dedf1412b461d9fe4ec9752e0}\label{class_signature_a114a817dedf1412b461d9fe4ec9752e0}} 
\index{Signature@{Signature}!get\_PE\_offset@{get\_PE\_offset}}
\index{get\_PE\_offset@{get\_PE\_offset}!Signature@{Signature}}
\doxysubsubsection{\texorpdfstring{get\_PE\_offset()}{get\_PE\_offset()}}
{\footnotesize\ttfamily int Signature\+::get\+\_\+\+PE\+\_\+offset (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Returns the offset of the PE header in the file. 

\begin{DoxyReturn}{Returns}
The offset of the PE header in the file. 
\end{DoxyReturn}
\mbox{\Hypertarget{class_signature_a832f49deb8bb78a2503cec99df5a0f3b}\label{class_signature_a832f49deb8bb78a2503cec99df5a0f3b}} 
\index{Signature@{Signature}!get\_Sections\_offset@{get\_Sections\_offset}}
\index{get\_Sections\_offset@{get\_Sections\_offset}!Signature@{Signature}}
\doxysubsubsection{\texorpdfstring{get\_Sections\_offset()}{get\_Sections\_offset()}}
{\footnotesize\ttfamily int Signature\+::get\+\_\+\+Sections\+\_\+offset (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Returns the offset of the section headers in the file. 

\begin{DoxyReturn}{Returns}
The offset of the section headers in the file. 
\end{DoxyReturn}
\mbox{\Hypertarget{class_signature_a8881448fcd549267f338a61957196dde}\label{class_signature_a8881448fcd549267f338a61957196dde}} 
\index{Signature@{Signature}!sum\_up\_bytes@{sum\_up\_bytes}}
\index{sum\_up\_bytes@{sum\_up\_bytes}!Signature@{Signature}}
\doxysubsubsection{\texorpdfstring{sum\_up\_bytes()}{sum\_up\_bytes()}}
{\footnotesize\ttfamily long int Signature\+::sum\+\_\+up\+\_\+bytes (\begin{DoxyParamCaption}\item[{unsigned short}]{size,  }\item[{int}]{pos = {\ttfamily -\/1} }\end{DoxyParamCaption})}



Reads the specified number of bytes from the file at the given position, and returns the sum of the bytes computed as an integer. 


\begin{DoxyParams}{Parameters}
{\em size} & The number of bytes to read. \\
\hline
{\em pos} & The position in the file to start reading from.\\
\hline
\end{DoxyParams}

\begin{DoxyExceptions}{Exceptions}
{\em std\+::invalid\+\_\+argument} & If the size parameter is greater than 4. \\
\hline
{\em std\+::ifstream\+::failure} & If the file cannot be read.\\
\hline
\end{DoxyExceptions}
\begin{DoxyReturn}{Returns}
The sum of the bytes computed as an integer. 
\end{DoxyReturn}


The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
signature.\+h\item 
signature.\+cpp\end{DoxyCompactItemize}
